# 作者       ：yangwuxie
# 创建时间   ：2020/7/15 14:51
import os
import sys
from typing import List, Tuple

import xlrd
from common.MultiException import SheetTypeError
import openpyxl
sys.path.append("..")


class ExcelReader(object):

    def __init__(self, excel, sheet=0, title_line=True):
        if os.path.exists(excel):
            self.excel = excel
        else:
            raise FileNotFoundError('文件不存在！')
        self.sheet = sheet
        self.title_line = title_line
        self._data = list()

    @property
    def data(self) -> list:
        """
        excel数据装入data中
        :return: [{column1},{column2},{column3}]
        """
        if not self._data:
            workbook = xlrd.open_workbook(self.excel)
            if type(self.sheet) not in [int, str]:
                raise SheetTypeError('Please pass in <type int> or <type str>, not {0}'.format(type(self.sheet)))
            elif type(self.sheet) == int:
                s = workbook.sheet_by_index(self.sheet)
            else:
                s = workbook.sheet_by_name(self.sheet)

            if self.title_line:
                title = s.row_values(0)  # 首行为title
                for col in range(1, s.nrows):
                    # 依次遍历其余行，与首行组成dict，拼到self._data中
                    self._data.append(dict(zip(title, s.row_values(col))))
            else:
                for col in range(0, s.nrows):
                    # 遍历所有行，拼到self._data中
                    self._data.append(s.row_values(col))
        return self._data


class CumulativeExecutionResults():

    def __init__(self, filename: str):
        if filename.endswith("xls") or filename.endswith("xlsx"):
            if os.path.exists(filename):
                self.workbook = openpyxl.load_workbook(filename)
                self.sheet = self.workbook.get_sheet_by_name("Sheet1")
            else:
                self.workbook = openpyxl.Workbook(filename)
                self.sheet = self.workbook.create_sheet("Sheet1")

    def update_test_result(self, result_list: List[Tuple]):
        """
        [('AgentEntry', 'test_case_1', 'APP-代理人入职-个人基本信息提交', '0.498 s', '成功', ["断言的集合为  {'assert_kes_value': [{'msg': 'Success'}], 'expected_code': 200, 'assert_key_exists': 'infoId'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'infoId': '5f4ccc6fd31e0a7a86acfa21'}, 'success': True}", '']), ('AgentEntry', 'test_case_2', 'APP-代理人入职-个人银行卡信息提交', '0.371 s', '成功', ["断言的集合为  {'expected_code': 200, 'assert_key_exists': 'infoId'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'infoId': '5f4ccc70d31e0a7a86acfa22'}, 'success': True}", "断言的集合为  {'assert_kes_value': [{'msg': 'Success'}], 'expected_code': 200, 'assert_key_exists': 'infoId'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'infoId': '5f4ccc70d31e0a7a86acfa22'}, 'success': True}", '']), ('AgentEntry', 'test_case_3', 'APP-代理人入职-个人执业品质提交', '2.73 s', '成功', ["断言的集合为  {'expected_code': 200, 'assert_key_exists': 'infoId'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'infoId': '5f4ccc70d31e0a7a86acfa23'}, 'success': True}", "断言的集合为  {'assert_kes_value': [{'msg': 'Success'}], 'expected_code': 200, 'assert_key_exists': 'pdfPath'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'political': None, 'nation': None, 'education': None, 'workArea': None, 'bank': None, 'pdfPath': [{'path': 'https://contract-esign.oss-cn-hangzhou.aliyuncs.com/37554789268746dd9941cb53e7303aa1', 'name': '《心有灵犀保险代理人协议》'}]}, 'success': True}", '']), ('BusinessCard', 'test_case_1', 'APP-我的名片-查询信息', '0.537 s', '成功', ["断言的集合为  {'assert_kes_value': [{'msg': 'Success'}], 'expected_code': 200}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'agentId': 888000117, 'cardInfo': {'agentIdentity': 1, 'agentName': '朱卫杰', 'agentHeadImg': 'https://static-zh.wxb.com.cn/shattrath/business-card/avatar/2020/8/1740ed22a76.jpg', 'agentRankName': '资深经理', 'workYear': 2, 'vxQrImg': 'https://static-zh.wxb.com.cn/shattrath/business-card/qr-code/2019/12/16f3abcc816.jpg', 'agentMobile': '13770703079', 'agentHonor': [{'honorType': 'countryHonor', 'honorName': '银保监认证保险代理人'}, {'honorType': 'companyHonor', 'honorName': '终身管家式服务，协助理赔'}], 'supportCount': 0, 'servicePersonCount': 10, 'glanceCount': 10, 'glanceHeadImg': [None, None, None, 'http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKZ3DWaew8eiaVwSkv7RaPficT9y68liaT8o8wskqog3OF9e3fyoaU7xtWVCmic1vnAFicf04ibReJA9APQ/132'], 'agentIntroduction': '本人拥有丰富的保险行业从业经验，可提供寿险、财险、车险、团体险，以及全方位专业科学的保险方案推荐。用保险筑起家庭的防火墙，让财富有效增值。', 'workExperience': [{'companyName': '心有灵犀保代', 'rankName': '规划师', 'joinDate': '2019.08', 'leftDate': '至今', 'workExperienceId': 1}], 'personalShow': ['https://static-zh.wxb.com.cn/shattrath/business-card/personal-show/2020/8/1740ef4beaa.jpg'], 'certificationInfo': {'certificationNo': '21009000000080002019000232', 'companyName': '众汇江苏分公司', 'agentName': '朱卫杰', 'agentSex': '男', 'agentIdentifyCardType': '身份证', 'agentIdentifyCardNo': '21312313232312347', 'certificationName': '保险销售从业人员执业证书', 'certificationWebStation': 'http://iir.circ.gov.cn', 'agentCode': 'W20190708002', 'agentSalesScope': '代理销售保险产品，代理收取保险费，代理相关保险业务的损失查勘和理赔，中国银保监会批准的其他业务', 'agentSalesArea': '', 'createDate': '2019-08-23', 'issueDate': '2019-08-23', 'complaintMobile': '4008880709', 'img': 'https://static-zh.wxb.com.cn/shattrath/business-card/avatar/2020/8/1740ed22a76.jpg'}}, 'defaultInfo': {'introduction': ['本人拥有丰富的保险行业从业经验，可提供寿险、财险、车险、团体险，以及全方位专业科学的保险方案推荐。用保险筑起家庭的防火墙，让财富有效增值。', '用我的专业知识，结合您的实际需求，为您提供全方位个性化的保险保障。', '为您解读保险条款，避开保险误区，配置保险组合，您的满意是我最低的要求。', '多年的保险从业经验，让我明白一个道理，那就是用诚信换取客户的信任。'], 'companyIntroduction': '心有灵犀保险代理有限公司成立于2013年7月，六年多来一直为客户提供中立、专业的保险理财咨询和风险管理服务，目前拥有10余家省级分公司，代理逾80家保险公司的上千款优质保险产品，并通过线上渠道及线下书院的服务闭环，为保险规划师与用户之间营造信任、可持续的良性关系。', 'rankNameList': ['总监', '资深经理', '保险规划师']}, 'visitingCardNo': '1377070307972'}, 'success': True}", '']), ('BusinessCard', 'test_case_2', 'APP-我的名片-编辑个人基本信息', '0.175 s', '成功', ["断言的集合为  {'assert_kes_value': [{'msg': 'Success'}], 'expected_code': 200}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': None, 'success': True}", '']), ('BusinessCard', 'test_case_3', 'APP-我的名片-编辑个人介绍', '0.141 s', '成功', ["断言的集合为  {'assert_kes_value': [{'msg': 'Success'}], 'expected_code': 200}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': None, 'success': True}", '']), ('BusinessCard', 'test_case_4', 'APP-我的名片-编辑从业经历', '0.181 s', '成功', ["断言的集合为  {'assert_kes_value': [{'msg': 'Success'}], 'expected_code': 200}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': None, 'success': True}", '']), ('BusinessCard', 'test_case_5', 'APP-我的名片-编辑个人风采', '0.272 s', '成功', ["断言的集合为  {'assert_kes_value': [{'msg': 'Success'}], 'expected_code': 200}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': None, 'success': True}", '']), ('CustMaterial', 'test_case_1', 'APP-获客素材-海报信息查询', '0.241 s', '成功', ["断言的集合为  {'assert_kes_value': [{'msg': 'Success'}, {'code': 10000}], 'expected_code': 200, 'assert_key_exists': 'posterUrl'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'totalCount': 14, 'page': 1, 'hasRecommend': True, 'list': [{'id': 67, 'posterUrl': 'https://static-zh.wxb.com.cn//karazhan/content/poster/2019/11/16e72db330c.jpg', 'contentClassId': 59, 'contentClassName': '节气', 'status': 1, 'statusMsg': '已发布', 'recommend': 1, 'recommendMsg': '已推荐', 'createTime': '2019-12-24 15:02:08', 'forwordNum': 56}, {'id': 81, 'posterUrl': 'https://static-zh.wxb.com.cn/karazhan/content/poster/2020/4/17177a43905.jpg', 'contentClassId': 59, 'contentClassName': '节气', 'status': 1, 'statusMsg': '已发布', 'recommend': 0, 'recommendMsg': '未推荐', 'createTime': '2020-04-14 15:43:19', 'forwordNum': 0}, {'id': 80, 'posterUrl': 'https://static-zh.wxb.com.cn/karazhan/content/poster/2020/2/17080370b43.jpeg', 'contentClassId': 59, 'contentClassName': '节气', 'status': 1, 'statusMsg': '已发布', 'recommend': 0, 'recommendMsg': '未推荐', 'createTime': '2020-02-26 14:37:39', 'forwordNum': 1}, {'id': 79, 'posterUrl': 'https://static-zh.wxb.com.cn/karazhan/content/poster/2020/1/16fc09cb448.jpg', 'contentClassId': 59, 'contentClassName': '节气', 'status': 1, 'statusMsg': '已发布', 'recommend': 0, 'recommendMsg': '未推荐', 'createTime': '2020-01-20 09:41:39', 'forwordNum': 10}, {'id': 69, 'posterUrl': 'https://static-zh.wxb.com.cn//karazhan/content/poster/2019/11/16e73392d7e.png', 'contentClassId': 59, 'contentClassName': '节气', 'status': 1, 'statusMsg': '已发布', 'recommend': 0, 'recommendMsg': '未推荐', 'createTime': '2019-12-24 15:02:08', 'forwordNum': 13}, {'id': 73, 'posterUrl': 'https://static-zh.wxb.com.cn//karazhan/content/poster/2019/11/16e7d0bbdf5.jpg', 'contentClassId': 59, 'contentClassName': '节气', 'status': 1, 'statusMsg': '已发布', 'recommend': 0, 'recommendMsg': '未推荐', 'createTime': '2019-12-24 15:02:08', 'forwordNum': 7}]}, 'success': True}", '']), ('CustMaterial', 'test_case_2', 'APP-获客素材-海报分类查询', '0.414 s', '成功', ["断言的集合为  {'assert_kes_value': [{'msg': 'Success'}, {'code': 10000}], 'expected_code': 200, 'assert_key_exists': 'totalCount'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'totalCount': 3, 'page': None, 'list': [{'id': 62, 'name': 'qweq', 'icon': 'https://zh-static-files.oss-cn-hangzhou.aliyuncs.com//karazhan/content/poster/2019/11/16e7e8c3368.png', 'contentCount': 4, 'createTime': '2019-11-18 20:45:49', 'sort': 7}, {'id': 59, 'name': '节气', 'icon': 'https://zh-static-files.oss-cn-hangzhou.aliyuncs.com//karazhan/content/poster/2019/11/16e72dae5ae.jpg', 'contentCount': 10, 'createTime': '2019-11-16 14:16:20', 'sort': 9}, {'id': 69, 'name': '测试分类', 'icon': 'https://static-zh.wxb.com.cn/karazhan/content/icon/2020/1/16f7a22cb1e.JPG', 'contentCount': 0, 'createTime': '2020-01-06 17:14:42', 'sort': 20}]}, 'success': True}", "断言的集合为  {'assert_kes_value': [{'msg': 'Success'}, {'code': 10000}], 'expected_code': 200, 'assert_key_exists': 'totalCount'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'totalCount': 14, 'page': 1, 'hasRecommend': True, 'list': [{'id': 67, 'posterUrl': 'https://static-zh.wxb.com.cn//karazhan/content/poster/2019/11/16e72db330c.jpg', 'contentClassId': 59, 'contentClassName': '节气', 'status': 1, 'statusMsg': '已发布', 'recommend': 1, 'recommendMsg': '已推荐', 'createTime': '2019-12-24 15:02:08', 'forwordNum': 56}, {'id': 81, 'posterUrl': 'https://static-zh.wxb.com.cn/karazhan/content/poster/2020/4/17177a43905.jpg', 'contentClassId': 59, 'contentClassName': '节气', 'status': 1, 'statusMsg': '已发布', 'recommend': 0, 'recommendMsg': '未推荐', 'createTime': '2020-04-14 15:43:19', 'forwordNum': 0}, {'id': 80, 'posterUrl': 'https://static-zh.wxb.com.cn/karazhan/content/poster/2020/2/17080370b43.jpeg', 'contentClassId': 59, 'contentClassName': '节气', 'status': 1, 'statusMsg': '已发布', 'recommend': 0, 'recommendMsg': '未推荐', 'createTime': '2020-02-26 14:37:39', 'forwordNum': 1}, {'id': 79, 'posterUrl': 'https://static-zh.wxb.com.cn/karazhan/content/poster/2020/1/16fc09cb448.jpg', 'contentClassId': 59, 'contentClassName': '节气', 'status': 1, 'statusMsg': '已发布', 'recommend': 0, 'recommendMsg': '未推荐', 'createTime': '2020-01-20 09:41:39', 'forwordNum': 10}, {'id': 76, 'posterUrl': 'https://static-zh.wxb.com.cn//karazhan/content/poster/2019/11/16e7e8c6748.png', 'contentClassId': 62, 'contentClassName': 'qweq', 'status': 1, 'statusMsg': '已发布', 'recommend': 0, 'recommendMsg': '未推荐', 'createTime': '2019-12-24 15:02:08', 'forwordNum': 1}, {'id': 74, 'posterUrl': 'https://static-zh.wxb.com.cn//karazhan/content/poster/2019/11/16e7d0be066.jpg', 'contentClassId': 59, 'contentClassName': '节气', 'status': 1, 'statusMsg': '已发布', 'recommend': 0, 'recommendMsg': '未推荐', 'createTime': '2019-12-24 15:02:08', 'forwordNum': 6}, {'id': 73, 'posterUrl': 'https://static-zh.wxb.com.cn//karazhan/content/poster/2019/11/16e7d0bbdf5.jpg', 'contentClassId': 59, 'contentClassName': '节气', 'status': 1, 'statusMsg': '已发布', 'recommend': 0, 'recommendMsg': '未推荐', 'createTime': '2019-12-24 15:02:08', 'forwordNum': 7}, {'id': 72, 'posterUrl': 'https://static-zh.wxb.com.cn//karazhan/content/poster/2019/11/16e7d0b9431.jpg', 'contentClassId': 59, 'contentClassName': '节气', 'status': 1, 'statusMsg': '已发布', 'recommend': 0, 'recommendMsg': '未推荐', 'createTime': '2019-12-24 15:02:08', 'forwordNum': 4}, {'id': 69, 'posterUrl': 'https://static-zh.wxb.com.cn//karazhan/content/poster/2019/11/16e73392d7e.png', 'contentClassId': 59, 'contentClassName': '节气', 'status': 1, 'statusMsg': '已发布', 'recommend': 0, 'recommendMsg': '未推荐', 'createTime': '2019-12-24 15:02:08', 'forwordNum': 13}]}, 'success': True}", '']), ('CustMaterial', 'test_case_3', 'APP-获客素材-海报内容查看', '0.548 s', '成功', ["断言的集合为  {'assert_kes_value': [{'msg': 'Success'}, {'code': 10000}], 'expected_code': 200, 'assert_key_exists': 'vxQrImg'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'agentId': 888000117, 'agentName': '朱卫杰', 'agentHeadImg': 'https://static-zh.wxb.com.cn/shattrath/business-card/avatar/2020/8/1740ed22a76.jpg', 'rankName': '资深经理', 'agentHonor': [{'honorType': 'countryHonor', 'honorName': '银保监认证保险代理人'}, {'honorType': 'companyHonor', 'honorName': '终身管家式服务，协助理赔'}], 'companyName': '心有灵犀保险代理有限公司', 'visitingCardNo': '1377070307972', 'vxQrImg': 'https://static-zh.wxb.com.cn/shattrath/business-card/qr-code/2019/12/16f3abcc816.jpg', 'mobile': '13770703079'}, 'success': True}", "断言的集合为  {'assert_kes_value': [{'msg': 'Success'}, {'code': 10000}], 'expected_code': 200, 'assert_key_exists': 'nodeId'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'nodeId': '5f4ccc75d31e0a7a86acfa24'}, 'success': True}", "断言的集合为  {'assert_kes_value': [{'msg': 'Success'}, {'code': 10000}], 'expected_code': 200, 'assert_key_exists': 'rhinoAgentId'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'visitingCardNo': '1377070307972', 'rhinoAgentId': 888000117, 'name': '朱卫杰', 'companyName': '心有灵犀保险代理有限公司', 'headImg': 'https://static-zh.wxb.com.cn/shattrath/business-card/avatar/2020/8/1740ed22a76.jpg', 'vxQrImg': 'https://static-zh.wxb.com.cn/shattrath/business-card/qr-code/2019/12/16f3abcc816.jpg', 'introduction': '本人拥有丰富的保险行业从业经验，可提供寿险、财险、车险、团体险，以及全方位专业科学的保险方案推荐。用保险筑起家庭的防火墙，让财富有效增值。', 'mobile': '13770703079', 'rankName': '资深经理', 'workYear': 2, 'praise': 0, 'visitingRel': '5db15293d31e0a4b386a1c8b'}, 'success': True}", '']), ('CustMaterial', 'test_case_4', 'APP-获客素材-文章信息查询', '0.23 s', '成功', ["断言的集合为  {'assert_kes_value': [{'msg': 'Success'}, {'code': 10000}], 'expected_code': 200, 'assert_key_exists': 'articleCover'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'totalCount': 31, 'page': None, 'hasRecommend': True, 'recommendNum': 3, 'list': [{'id': 86, 'title': '测试文章123', 'articleCover': 'https://static-zh.wxb.com.cn/karazhan/content/article/2020/5/172029a8632.jpg', 'contentClassId': 68, 'contentClassName': '测试分类', 'author': '测试', 'taskTime': None, 'createTime': '2020-05-11 15:20:05', 'updateTime': '2020-05-11 16:17:48', 'status': 1, 'publishStatus': '已发布', 'recommend': 1, 'recommendStatus': '已推荐', 'forwordNum': 7, 'openNum': 42, 'contentDetail': None}, {'id': 31, 'title': '保险公司倒闭了，你的保险谁来赔？', 'articleCover': 'https://zh-static-files.oss-cn-hangzhou.aliyuncs.com//karazhan/content/article/2019/11/16e72eaefda.jpg', 'contentClassId': 54, 'contentClassName': '医疗险', 'author': None, 'taskTime': None, 'createTime': '2019-11-16 14:33:56', 'updateTime': '2019-11-19 16:13:23', 'status': 1, 'publishStatus': '已发布', 'recommend': 1, 'recommendStatus': '已推荐', 'forwordNum': 66, 'openNum': 475, 'contentDetail': None}, {'id': 28, 'title': '一家三口给谁先买？', 'articleCover': 'https://zh-static-files.oss-cn-hangzhou.aliyuncs.com//karazhan/content/article/2019/11/16e72e9b8cf.jpg', 'contentClassId': 54, 'contentClassName': '医疗险', 'author': None, 'taskTime': None, 'createTime': '2019-11-16 14:32:35', 'updateTime': '2019-11-16 14:32:35', 'status': 1, 'publishStatus': '已发布', 'recommend': 1, 'recommendStatus': '已推荐', 'forwordNum': 25, 'openNum': 179, 'contentDetail': None}, {'id': 87, 'title': '你好文章铪', 'articleCover': 'https://static-zh.wxb.com.cn/karazhan/content/article/2020/5/17202e5d2ad.png', 'contentClassId': 52, 'contentClassName': '重疾险', 'author': '金童', 'taskTime': None, 'createTime': '2020-05-11 16:41:59', 'updateTime': '2020-05-11 16:41:59', 'status': 1, 'publishStatus': '已发布', 'recommend': 0, 'recommendStatus': '未推荐', 'forwordNum': 1, 'openNum': 6, 'contentDetail': None}, {'id': 85, 'title': '回归测试文章分享', 'articleCover': 'https://static-zh.wxb.com.cn/karazhan/content/article/2020/4/171a5b3817c.jpg', 'contentClassId': 67, 'contentClassName': '意外险', 'author': '展飞', 'taskTime': None, 'createTime': '2020-04-23 14:23:03', 'updateTime': '2020-04-23 14:23:03', 'status': 1, 'publishStatus': '已发布', 'recommend': 0, 'recommendStatus': '未推荐', 'forwordNum': 3, 'openNum': 13, 'contentDetail': None}, {'id': 84, 'title': '测试文章3', 'articleCover': 'https://static-zh.wxb.com.cn/karazhan/content/article/2020/4/171779029e8.png', 'contentClassId': 54, 'contentClassName': '医疗险', 'author': 'zhanfei', 'taskTime': None, 'createTime': '2020-04-14 15:22:37', 'updateTime': '2020-04-22 17:25:46', 'status': 1, 'publishStatus': '已发布', 'recommend': 0, 'recommendStatus': '未推荐', 'forwordNum': 2, 'openNum': 11, 'contentDetail': None}, {'id': 83, 'title': '测试link', 'articleCover': 'https://static-zh.wxb.com.cn/karazhan/content/article/2020/4/17157c0ee92.png', 'contentClassId': 54, 'contentClassName': '医疗险', 'author': None, 'taskTime': None, 'createTime': '2020-04-08 11:06:41', 'updateTime': '2020-04-08 11:06:41', 'status': 1, 'publishStatus': '已发布', 'recommend': 0, 'recommendStatus': '未推荐', 'forwordNum': 0, 'openNum': 8, 'contentDetail': None}, {'id': 80, 'title': '测试文章预览1', 'articleCover': 'https://static-zh.wxb.com.cn/karazhan/content/article/2020/2/170845d5357.jpg', 'contentClassId': 54, 'contentClassName': '医疗险', 'author': 'zhanfei', 'taskTime': None, 'createTime': '2020-02-27 10:08:14', 'updateTime': '2020-02-27 10:08:28', 'status': 1, 'publishStatus': '已发布', 'recommend': 0, 'recommendStatus': '未推荐', 'forwordNum': 1, 'openNum': 8, 'contentDetail': None}, {'id': 76, 'title': 'qweqwe', 'articleCover': 'https://static-zh.wxb.com.cn/karazhan/content/article/2020/2/17080defb49.png', 'contentClassId': 67, 'contentClassName': '意外险', 'author': None, 'taskTime': None, 'createTime': '2020-02-26 17:41:04', 'updateTime': '2020-02-26 17:42:25', 'status': 1, 'publishStatus': '已发布', 'recommend': 0, 'recommendStatus': '未推荐', 'forwordNum': 0, 'openNum': 6, 'contentDetail': None}]}, 'success': True}", '']), ('CustMaterial', 'test_case_5', 'APP-获客素材-文章内容查看', '0.722 s', '成功', ["断言的集合为  {'assert_kes_value': [{'msg': 'Success'}, {'code': 10000}], 'expected_code': 200, 'assert_key_exists': 'title'}", '接口返回的结果【用来断言】为 {\'code\': 10000, \'msg\': \'Success\', \'data\': {\'id\': 31, \'title\': \'保险公司倒闭了，你的保险谁来赔？\', \'articleCover\': \'https://zh-static-files.oss-cn-hangzhou.aliyuncs.com//karazhan/content/article/2019/11/16e72eaefda.jpg\', \'contentClassId\': 54, \'contentClassName\': \'医疗险\', \'author\': None, \'taskTime\': None, \'createTime\': \'2019-11-16 14:33:56\', \'updateTime\': \'2019-11-19 16:13:23\', \'status\': 1, \'publishStatus\': \'已发布\', \'recommend\': 1, \'recommendStatus\': \'已推荐\', \'forwordNum\': 66, \'openNum\': 476, \'contentDetail\': \'<h2><span class="ql-lineHeight-2"> 保险</span><span class="ql-lineHeight-2" style="color: rgb(153, 153, 153);">公司倒闭</span><span class="ql-lineHeight-2">了，你</span><span class="ql-lineHeight-2" style="background-color: rgb(255, 112, 39);">的保险谁</span><span class="ql-lineHeight-2">来赔？</span></h2><h2><span class="ql-lineHeight-2">保险公司倒闭了，你的保险谁来赔？</span></h2><h2>保险<span class="ql-size-large">公司倒闭</span>了，<span class="ql-size-small">你的保险</span>谁来赔？</h2><p><img src="https://zh-static-files.oss-cn-hangzhou.aliyuncs.com//karazhan/content/article/2019/11/16e82b23c71.png"></p>\'}, \'success\': True}', "断言的集合为  {'assert_kes_value': [{'msg': 'Success'}, {'code': 10000}], 'expected_code': 200, 'assert_key_exists': 'vxQrImg'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'agentId': 888000117, 'agentName': '朱卫杰', 'agentHeadImg': 'https://static-zh.wxb.com.cn/shattrath/business-card/avatar/2020/8/1740ed22a76.jpg', 'rankName': '资深经理', 'agentHonor': [{'honorType': 'countryHonor', 'honorName': '银保监认证保险代理人'}, {'honorType': 'companyHonor', 'honorName': '终身管家式服务，协助理赔'}], 'companyName': '心有灵犀保险代理有限公司', 'visitingCardNo': '1377070307972', 'vxQrImg': 'https://static-zh.wxb.com.cn/shattrath/business-card/qr-code/2019/12/16f3abcc816.jpg', 'mobile': '13770703079'}, 'success': True}", "断言的集合为  {'assert_kes_value': [{'msg': 'Success'}, {'code': 10000}], 'expected_code': 200, 'assert_key_exists': 'account'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'account': '0e59e1f31abe4d1bb272d1245db77e1d'}, 'success': True}", '']), ('CustMaterial', 'test_case_6', 'APP-获客素材-线索客户信息查询', '0.741 s', '成功', ["断言的集合为  {'assert_kes_value': [{'msg': 'Success'}, {'code': 10000}], 'expected_code': 200, 'assert_key_exists': 'totalCount'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'pageNo': 1, 'pageSize': 10, 'totalCount': 10, 'gainCustomerList': [{'customerInfoDto': {'nickName': 'Leo', 'headImgUrl': 'http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKZ3DWaew8eiaVwSkv7RaPficT9y68liaT8o8wskqog3OF9e3fyoaU7xtWVCmic1vnAFicf04ibReJA9APQ/132', 'content': '查看名片', 'activeTime': '2020-08-27 11:09:40', 'customerId': 666000531, 'detailTitle': '我是保险规划师朱卫杰，这是我的名片。', 'operaType': 4, 'relativeCustomerType': None, 'relativeCustomerId': None, 'agentCusId': None, 'tags': {}}, 'interCount': 1}, {'customerInfoDto': {'nickName': 'Leo', 'headImgUrl': 'http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKZ3DWaew8eiaVwSkv7RaPficT9y68liaT8o8wskqog3OF9e3fyoaU7xtWVCmic1vnAFicf04ibReJA9APQ/132', 'content': '查看名片', 'activeTime': '2020-04-23 14:36:46', 'customerId': 666000134, 'detailTitle': '我是保险规划师朱卫杰，这是我的名片。', 'operaType': 4, 'relativeCustomerType': None, 'relativeCustomerId': None, 'agentCusId': None, 'tags': {}}, 'interCount': 14}, {'customerInfoDto': {'nickName': '会飞', 'headImgUrl': 'http://thirdwx.qlogo.cn/mmopen/vi_32/AicRibibwhnWAWoJxvs4ibRBk6ic8YjrXiczMxtzHlic83PT4FtiaSj5vmIWD9WSst1h7PtqdRmGWKeyDNiatjdqS3lsY6A/132', 'content': '查看计划书《倍倍加》', 'activeTime': '2020-01-08 15:08:07', 'customerId': 666000082, 'detailTitle': '倍倍加', 'operaType': 2, 'relativeCustomerType': None, 'relativeCustomerId': None, 'agentCusId': None, 'tags': {}}, 'interCount': 117}, {'customerInfoDto': {'nickName': None, 'headImgUrl': None, 'content': '阅读了资讯《一家三口给谁先买？》', 'activeTime': '2019-12-26 14:20:25', 'customerId': 666000059, 'detailTitle': '一家三口给谁先买？', 'operaType': 11, 'relativeCustomerType': None, 'relativeCustomerId': None, 'agentCusId': None, 'tags': {}}, 'interCount': 137}, {'customerInfoDto': {'nickName': '何玮', 'headImgUrl': 'http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoeTew5z5ZzHgnGTKVrNkJLM4Qc0Nq8LXG3jQgArOzDn4rmOfLHD5GSkxLXaflErPqNkc30fdic9wA/132', 'content': '阅读了资讯《保险公司倒闭了，你的保险谁来赔？》', 'activeTime': '2019-12-25 15:03:23', 'customerId': 666000055, 'detailTitle': '保险公司倒闭了，你的保险谁来赔？', 'operaType': 11, 'relativeCustomerType': None, 'relativeCustomerId': None, 'agentCusId': None, 'tags': {}}, 'interCount': 24}, {'customerInfoDto': {'nickName': 'silence_xy', 'headImgUrl': 'http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL2VH53lyG0FicNnzTEB8kNhq2Pg33ibTRoeSCmDKKwcwnIfOPRfQbB6z8mBhXHEDNjWG5WEjlT7qaw/132', 'content': '阅读了资讯《老年人保险有必要买吗？》', 'activeTime': '2019-12-24 16:11:31', 'customerId': 666000132, 'detailTitle': '老年人保险有必要买吗？', 'operaType': 11, 'relativeCustomerType': None, 'relativeCustomerId': None, 'agentCusId': None, 'tags': {}}, 'interCount': 18}, {'customerInfoDto': {'nickName': 'Bob', 'headImgUrl': 'http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLjcdUzYQSAzFeCrH46DeSMiaCeQIULERnThE77IibrlxiaUiaOxxGyViao74kqz7fVicrI9vEicEOOArcmQ/132', 'content': '自行上传保单照片《跆拳道初级一》', 'activeTime': '2019-12-20 15:31:06', 'customerId': 666000058, 'detailTitle': '跆拳道初级一', 'operaType': 12, 'relativeCustomerType': None, 'relativeCustomerId': None, 'agentCusId': None, 'tags': {}}, 'interCount': 1}, {'customerInfoDto': {'nickName': '巴巴', 'headImgUrl': 'http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erQicWIXWxvWR3tPMe2CWjEG9QrVRywhIF4icqP5xalhblNY2OComWA6kCVvqy5ibMWX6WOnIVopibsyw/132', 'content': '阅读了资讯《两款最适合养老的年金，不看绝对后悔！》', 'activeTime': '2019-11-18 11:43:34', 'customerId': 666000028, 'detailTitle': '两款最适合养老的年金，不看绝对后悔！', 'operaType': 11, 'relativeCustomerType': None, 'relativeCustomerId': None, 'agentCusId': None, 'tags': {}}, 'interCount': 1}, {'customerInfoDto': {'nickName': '青灵魂', 'headImgUrl': 'http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erx3dZgYibgcQ38Nm5k4E5xFYUfCyBOTdE5dWkEwCDyVkwI51kibCKkiachpa3WSibib5YicgoKyexxhZwA/132', 'content': '分享文章《长期医疗险》', 'activeTime': '2019-11-16 17:41:36', 'customerId': 666000125, 'detailTitle': '长期医疗险', 'operaType': 10, 'relativeCustomerType': None, 'relativeCustomerId': None, 'agentCusId': None, 'tags': {}}, 'interCount': 2}, {'customerInfoDto': {'nickName': '陳哲同學ヾ', 'headImgUrl': 'http://thirdwx.qlogo.cn/mmopen/vi_32/hgsbUTIBVtpNp8S8Kwc64ceY22bqsiagajc92fibQMic7Yg7QuibSOz6KH7dCYfbgYAYQljtFM6tnwOMtCMFa8ptibw/132', 'content': '分享文章《》', 'activeTime': '2019-11-16 13:49:45', 'customerId': 666000127, 'detailTitle': '', 'operaType': 10, 'relativeCustomerType': None, 'relativeCustomerId': None, 'agentCusId': None, 'tags': {}}, 'interCount': 2}]}, 'success': True}", "断言的集合为  {'assert_kes_value': [{'msg': 'Success'}, {'code': 10000}], 'expected_code': 200, 'assert_key_exists': 'nickName'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'nickName': 'Leo', 'headImgUrl': 'http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKZ3DWaew8eiaVwSkv7RaPficT9y68liaT8o8wskqog3OF9e3fyoaU7xtWVCmic1vnAFicf04ibReJA9APQ/132', 'trackList': [{'activeTime': '2020-08-27 11:09:39', 'content': '查看名片', 'operaType': 4, 'detailId': '1377070307972', 'detailTitle': '我是保险规划师朱卫杰，这是我的名片。', 'stayTime': 1053, 'stayTimes': '17分钟33秒', 'customerList': [{'nickName': None, 'headImgUrl': None}, {'nickName': 'Leo', 'headImgUrl': 'http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKZ3DWaew8eiaVwSkv7RaPficT9y68liaT8o8wskqog3OF9e3fyoaU7xtWVCmic1vnAFicf04ibReJA9APQ/132'}]}]}, 'success': True}", "断言的集合为  {'assert_kes_value': [{'msg': 'Success'}, {'code': 10000}], 'expected_code': 200}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'customerBasicInfo': None, 'customerOrderInfoList': None, 'customerServiceInfoList': None, 'sourceInfo': None}, 'success': True}", '']), ('FansQuery', 'test_query', '粉丝查询流程', '0.412 s', '成功', ["断言的集合为  {'msg': 'Success', 'success': True, 'nickName': 'Potential'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': [{'openId': 'o-xTvwdgnU1dOkayurYlzD4GgHIk', 'nickName': 'Potential', 'wxType': '2C', 'wxTypeStr': '灵犀喂小保', 'subscribeTime': '2020-06-28 09:34:48'}], 'success': True}", '']), ('FansQuery', 'test_query_with_wrong_nickname', '粉丝查询异常：带错误的昵称信息', '0.372 s', '成功', ["断言的集合为  {'msg': 'Success', 'success': True, 'code': '10000'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': [], 'success': True}", '']), ('FansQuery', 'test_query_without_nickname', '粉丝查询异常：不带昵称', '0.133 s', '成功', ["断言的集合为  {'msg': 'Success', 'success': True, 'data': []}", '接口返回的结果【用来断言】为 {\'code\': 99999, \'msg\': "Required String parameter \'nickName\' is not present", \'data\': None, \'success\': False}', '']), ('InsWorkNumber', 'test_case_1', 'APP-险企工号-代理人的险企工号查询', '0.116 s', '成功', ["断言的集合为  {'assert_kes_value': [{'msg': 'Success'}, {'code': 10000}], 'expected_code': 200, 'assert_key_exists': 'workNumber'}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'list': [{'companyCode': 'fubon', 'companyName': '富邦财险', 'status': 0, 'workNumber': 'LX77771'}]}, 'success': True}", '']), ('PlanToCustomize', 'test_planToCustomize', '\n        方案定制正常流程\n        :return:\n        ', '0.804 s', '成功', ["断言的集合为  {'assert_kes_value': [{'statusDesc': '已完成'}]}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'total': 27, 'currentPage': 1, 'data': [{'name': '你们', 'nickName': 'Leo', 'createTime': '2020-08-07', 'status': 3, 'statusDesc': '已完成', 'flowId': '5f2d0980d31e0aa26c7a7d02'}, {'name': '虢伟亮', 'nickName': 'Potential', 'createTime': '2020-08-06', 'status': 3, 'statusDesc': '已完成', 'flowId': '5f2b6099d31e0aa26c7a7cf1'}, {'name': '虢伟亮', 'nickName': 'Potential', 'createTime': '2020-08-03', 'status': 3, 'statusDesc': '已完成', 'flowId': '5f27e4c2d31e0a150277a568'}, {'name': '虢伟亮', 'nickName': 'Potential', 'createTime': '2020-08-03', 'status': 3, 'statusDesc': '已完成', 'flowId': '5f27d054d31e0a1c343c8581'}, {'name': '虢伟亮', 'nickName': 'Potential', 'createTime': '2020-08-03', 'status': 3, 'statusDesc': '已完成', 'flowId': '5f27bfadd31e0a1c343c8580'}, {'name': '虢伟亮', 'nickName': 'Potential', 'createTime': '2020-08-03', 'status': 3, 'statusDesc': '已完成', 'flowId': '5f27bb3bd31e0ac18bac2adb'}, {'name': 'micro', 'nickName': 'silence_xy', 'createTime': '2020-07-31', 'status': 3, 'statusDesc': '已完成', 'flowId': '5f23883ad31e0af435ffc2f6'}, {'name': '给我', 'nickName': 'Potential', 'createTime': '2020-07-24', 'status': 3, 'statusDesc': '已完成', 'flowId': '5f1a909ed31e0adeffe1ef07'}, {'name': '寒暑假', 'nickName': 'Potential', 'createTime': '2020-07-24', 'status': 3, 'statusDesc': '已完成', 'flowId': '5f1a8a4ad31e0adeffe1ef05'}, {'name': '烦烦烦', 'nickName': 'Potential', 'createTime': '2020-07-24', 'status': 3, 'statusDesc': '已完成', 'flowId': '5f1a8897d31e0adeffe1ef03'}]}, 'success': True}", "断言的集合为  {'assert_kes_value': [{'success': True}, {'msg': 'Success'}]}", "接口返回的结果【用来断言】为 {'code': 10000, 'msg': 'Success', 'data': {'flowId': '5f2d0980d31e0aa26c7a7d02', 'step': 5, 'weChatPubName': '喂小保公众号', 'channelName': None, 'status': '已完成', 'price': 0, 'createTime': '2020-08-07 15:57:52', 'customerNickName': '你们', 'sex': '男', 'nickName': 'Leo', 'addressInfo': '浙江省杭州市', 'planInsuredTime': '1周', 'mobile': '17602116237', 'familyMember': '本人', 'yearIncome': '25万~40万', 'familyDebt': '58', 'premiumBudget': '216', 'insuranceMember': '本人', 'insuranceDetails': [{'insurName': '本人', 'birthday': '1989-06-15', 'haveSocialSecurity': '否', 'diseases': '无', 'haveInsurance': '否', 'jobType': '室外'}], 'adviserInfo': None}, 'success': True}", '']), ('FosunUnderwrite', 'test_case_1', '供应链-复星联合倍吉星产品核保数据提交', '1.14 s', '成功', ["断言的集合为  {'assert_kes_value': [{'code': 10000}], 'expected_code': 200, 'assert_key_exists': 'orderNo'}", '接口返回的结果【用来断言】为 {\'batchNo\': \'test5020d31e0aa60b433701\', \'orderNo\': \'test426172351476401\', \'code\': 10000, \'msg\': \'\', \'body\': \'{"code":1,"msg":"处理成功","printNo":"1300100000304767"}\'}', '']), ('FosunUnderwrite', 'test_case_2', '供应链-复星联合超越保产品核保数据提交', '0.808 s', '成功', ["断言的集合为  {'assert_kes_value': [{'code': 10000}], 'expected_code': 200, 'assert_key_exists': 'orderNo'}", '接口返回的结果【用来断言】为 {\'batchNo\': \'test5020d31e0aa60b490351\', \'orderNo\': \'test426172351451144\', \'code\': 10000, \'msg\': \'\', \'body\': \'{"code":1,"msg":"处理成功","printNo":"1300100000304768"}\'}', '']), ('FosunUnderwrite', 'test_case_3', '供应链-复星联合康乐一生B款产品核保数据提交', '0.845 s', '成功', ["断言的集合为  {'assert_kes_value': [{'code': 10000}], 'expected_code': 200, 'assert_key_exists': 'orderNo'}", '接口返回的结果【用来断言】为 {\'batchNo\': \'test5020d31e0aa60b433689\', \'orderNo\': \'test426172351454535\', \'code\': 10000, \'msg\': \'\', \'body\': \'{"code":1,"msg":"处理成功","printNo":"1300100000304769"}\'}', '']), ('FosunUnderwrite', 'test_case_4', '供应链-复星联合妈咪保贝产品核保数据提交', '0.787 s', '成功', ["断言的集合为  {'assert_kes_value': [{'code': 10000}], 'expected_code': 200, 'assert_key_exists': 'orderNo'}", '接口返回的结果【用来断言】为 {\'batchNo\': \'test5020d31e0aa60b491986\', \'orderNo\': \'test426172351410398\', \'code\': 10000, \'msg\': \'\', \'body\': \'{"code":1,"msg":"处理成功","printNo":"1300100000304770"}\'}', ''])]
        :param result_list:
        :return:
        """
        for case_result in result_list:
            if case_result.index(0) in list(self.sheet.columns[0]):
                pass



if __name__ == '__main__':
    data = CumulativeExecutionResults(r"C:\Users\Administrator\Desktop\casepassresult.xlsx")
    print(list(data.sheet.rows[0:]))
